# Online Status Feature - Architecture Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         DATING APP - ONLINE STATUS                       â”‚
â”‚                          Real-time Architecture                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   User A Device  â”‚                              â”‚   User B Device  â”‚
â”‚  (Browser Tab)   â”‚                              â”‚  (Browser Tab)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                                                 â”‚
         â”‚ Opens App                                       â”‚ Opens App
         â”‚ Sets Status: Online                             â”‚ Sets Status: Online
         â–¼                                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        REACT COMPONENTS LAYER                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚   MessagesPage.jsx   â”‚         â”‚ ConversationsList    â”‚            â”‚
â”‚  â”‚                      â”‚         â”‚        .jsx          â”‚            â”‚
â”‚  â”‚  â€¢ Online Status     â”‚         â”‚                      â”‚            â”‚
â”‚  â”‚  â€¢ Typing Indicator  â”‚         â”‚  â€¢ Avatar Badges     â”‚            â”‚
â”‚  â”‚  â€¢ Read Receipts     â”‚         â”‚  â€¢ Online Dots       â”‚            â”‚
â”‚  â”‚  â€¢ Message List      â”‚         â”‚  â€¢ Ripple Animation  â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚             â”‚                                â”‚                         â”‚
â”‚             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚
â”‚                          â”‚                                             â”‚
â”‚                          â–¼                                             â”‚
â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                 â”‚
â”‚            â”‚  CUSTOM HOOKS LAYER     â”‚                                 â”‚
â”‚            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                                 â”‚
â”‚            â”‚                         â”‚                                 â”‚
â”‚            â”‚  useOnlineStatus()      â”‚ â† Monitor single user           â”‚
â”‚            â”‚  useMultipleStatuses()  â”‚ â† Monitor multiple users        â”‚
â”‚            â”‚  useSetOnlineStatus()   â”‚ â† Set current user status       â”‚
â”‚            â”‚                         â”‚                                 â”‚
â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚
â”‚                         â”‚                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â”‚ Firebase Realtime Database SDK
                          â”‚ (WebSocket Connection)
                          â”‚
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   FIREBASE REALTIME DATABASE                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   /status          â”‚  â”‚   /messages        â”‚  â”‚   /typing        â”‚  â”‚
â”‚  â”‚                    â”‚  â”‚                    â”‚  â”‚                  â”‚  â”‚
â”‚  â”‚  /{userId}         â”‚  â”‚  /{conversationId} â”‚  â”‚  /{convId}       â”‚  â”‚
â”‚  â”‚    â€¢ online: bool  â”‚  â”‚    /{messageId}    â”‚  â”‚    /{userId}     â”‚  â”‚
â”‚  â”‚    â€¢ lastSeen: ts  â”‚  â”‚      â€¢ senderId    â”‚  â”‚      : boolean   â”‚  â”‚
â”‚  â”‚                    â”‚  â”‚      â€¢ text        â”‚  â”‚                  â”‚  â”‚
â”‚  â”‚  Example:          â”‚  â”‚      â€¢ timestamp   â”‚  â”‚  Example:        â”‚  â”‚
â”‚  â”‚  /user123          â”‚  â”‚      â€¢ seen: bool  â”‚  â”‚  /conv456        â”‚  â”‚
â”‚  â”‚    online: true    â”‚  â”‚                    â”‚  â”‚    /user123      â”‚  â”‚
â”‚  â”‚    lastSeen: 1732  â”‚  â”‚  Example:          â”‚  â”‚      : true      â”‚  â”‚
â”‚  â”‚                    â”‚  â”‚  /conv456          â”‚  â”‚                  â”‚  â”‚
â”‚  â”‚                    â”‚  â”‚    /msg789         â”‚  â”‚                  â”‚  â”‚
â”‚  â”‚                    â”‚  â”‚      senderId:123  â”‚  â”‚                  â”‚  â”‚
â”‚  â”‚                    â”‚  â”‚      text:"Hi!"    â”‚  â”‚                  â”‚  â”‚
â”‚  â”‚                    â”‚  â”‚      seen: true    â”‚  â”‚                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           DATA FLOW DIAGRAM                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1. USER OPENS APP
   User A Opens App
        â”‚
        â”œâ”€â–º useSetOnlineStatus() hook activates
        â”‚
        â””â”€â–º Writes to /status/userA_uid
                { online: true, lastSeen: serverTimestamp() }

2. VIEWING ONLINE STATUS
   User B Views Conversation List
        â”‚
        â”œâ”€â–º useMultipleOnlineStatuses([userA_uid, userC_uid, ...])
        â”‚
        â”œâ”€â–º Subscribes to /status/userA_uid
        â”‚
        â””â”€â–º Receives real-time updates
                â†“
            Updates UI with green badge if online

3. TYPING INDICATOR
   User A Types Message
        â”‚
        â”œâ”€â–º onChange event in input field
        â”‚
        â”œâ”€â–º Writes to /typing/conversationId/userA_uid = true
        â”‚
        â””â”€â–º User B's listener receives update
                â†“
            Shows "typing..." animation

4. SENDING MESSAGE
   User A Sends Message
        â”‚
        â”œâ”€â–º Writes to /messages/conversationId/newMessageId
        â”‚       { senderId, text, timestamp, seen: false }
        â”‚
        â”œâ”€â–º Clears typing indicator
        â”‚       /typing/conversationId/userA_uid = false
        â”‚
        â””â”€â–º User B's listener receives new message
                â†“
            Message appears in chat

5. READ RECEIPT
   User B Views Message
        â”‚
        â”œâ”€â–º useEffect detects unread messages
        â”‚
        â”œâ”€â–º Updates /messages/conversationId/messageId
        â”‚       { seen: true }
        â”‚
        â””â”€â–º User A's listener receives update
                â†“
            "Sent" changes to "Seen"

6. USER CLOSES APP
   User A Closes Tab
        â”‚
        â”œâ”€â–º beforeunload event fires
        â”‚
        â””â”€â–º Updates /status/userA_uid
                { online: false, lastSeen: serverTimestamp() }
                â†“
            User B sees "Last seen: [timestamp]"


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        COMPONENT HIERARCHY                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

App
 â”‚
 â”œâ”€â–º AuthProvider (context)
 â”‚    â””â”€â–º useSetOnlineStatus(user.uid)  â† Sets current user online
 â”‚
 â”œâ”€â–º MessagesPage
 â”‚    â”‚
 â”‚    â”œâ”€â–º useOnlineStatus(receiver.uid)  â† Monitor receiver's status
 â”‚    â”‚    â””â”€â–º Shows: "ğŸŸ¢ Online" or "Last seen: ..."
 â”‚    â”‚
 â”‚    â”œâ”€â–º Typing Indicator Logic
 â”‚    â”‚    â”œâ”€â–º Listen: /typing/{convId}/{receiverId}
 â”‚    â”‚    â””â”€â–º Write: /typing/{convId}/{currentUserId}
 â”‚    â”‚
 â”‚    â””â”€â–º Message Read Receipts
 â”‚         â”œâ”€â–º Listen: /messages/{convId}
 â”‚         â””â”€â–º Update: seen = true when viewed
 â”‚
 â””â”€â–º ConversationsList
      â”‚
      â””â”€â–º useMultipleOnlineStatuses(allUserIds)  â† Monitor all users
           â””â”€â–º Shows: Badge with green dot for online users


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         VISUAL INDICATORS                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ONLINE STATUS:
  ğŸŸ¢ Online              â† Green dot + "Online" text
  âš« Last seen: 2:30 PM  â† Gray text with timestamp

AVATAR BADGE:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  ğŸ‘¤     â”‚
  â”‚      ğŸŸ¢ â”‚  â† Animated green badge with ripple effect
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

TYPING INDICATOR:
  typing...  â† Blue pulsing text

READ RECEIPTS:
  Sent  â† Gray text (message not seen)
  Seen  â† Blue text (message viewed)


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      SECURITY & PERMISSIONS                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

/status/{userId}
  READ:  âœ… Anyone (public presence)
  WRITE: âœ… Only if userId === auth.uid

/messages/{conversationId}
  READ:  âœ… Authenticated users (participants)
  WRITE: âœ… Authenticated users (participants)

/typing/{conversationId}/{userId}
  READ:  âœ… Anyone in conversation
  WRITE: âœ… Only if userId === auth.uid


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PERFORMANCE OPTIMIZATIONS                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1. Efficient Listeners
   â€¢ Only subscribe to needed paths
   â€¢ Automatic cleanup on unmount
   â€¢ No memory leaks

2. Minimal Data Transfer
   â€¢ Only status changes are synced
   â€¢ Focused database queries
   â€¢ No polling, pure push updates

3. Real-time Updates
   â€¢ WebSocket connection
   â€¢ Sub-second latency
   â€¢ Instant UI updates

4. Optimized Rendering
   â€¢ React hooks prevent unnecessary re-renders
   â€¢ Memoized components where needed
   â€¢ Efficient state updates
